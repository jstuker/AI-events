{{ define "title" }}{{ .Title }} â€” {{ .Site.Title }}{{ end }}

{{ define "main" }}
<a href="{{ "/" | relURL }}" class="back-link">&larr; All Events</a>

{{ if eq .Kind "term" }}
{{/* Term page: list events belonging to this term */}}
{{ partial "event-card-styles.html" . }}

{{ $published := where .Pages "Params.status" "published" }}
{{ if $published }}
<ul class="events-list">
  {{- range $published }}
  {{ partial "event-card.html" . }}
  {{- end }}
</ul>
{{ else }}
<p style="margin-top: 1.5rem; color: var(--color-muted);">No published events found.</p>
{{ end }}

{{ else }}
{{/* Taxonomy overview page: list all terms with event counts */}}
<style>
  .taxonomy-list { list-style: none; display: grid; gap: 0.75rem; margin-top: 1.5rem; }
  .taxonomy-item {
    border: 1px solid var(--color-border);
    border-radius: 8px;
    padding: 1rem 1.25rem;
    min-height: 2.75rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: box-shadow 0.2s;
  }
  .taxonomy-item:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
  .taxonomy-item a { color: var(--color-text); text-decoration: none; font-weight: 500; }
  .taxonomy-item a:hover { color: var(--color-primary); }
  .taxonomy-count {
    background: #f3f4f6;
    color: var(--color-muted);
    font-size: 0.875rem;
    padding: 0.15rem 0.6rem;
    border-radius: 12px;
    font-weight: 600;
  }
</style>

<ul class="taxonomy-list">
  {{- range .Pages }}
  {{ $count := len (where .Pages "Params.status" "published") }}
  {{ if gt $count 0 }}
  <li class="taxonomy-item">
    <a href="{{ .RelPermalink }}">{{ .Title }}</a>
    <span class="taxonomy-count">{{ $count }}</span>
  </li>
  {{ end }}
  {{- end }}
</ul>
{{ end }}
{{ end }}
