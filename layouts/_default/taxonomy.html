{{ define "title" }}{{ .Title }} â€” {{ .Site.Title }}{{ end }}

{{ define "main" }}
<a href="{{ "/" | relURL }}" class="back-link">&larr; All Events</a>

{{ if eq .Kind "term" }}
{{/* Term page: list events belonging to this term */}}
{{ partial "event-card-styles.html" . }}

{{ $published := where .Pages "Params.status" "published" }}
{{ if $published }}
<ul class="events-list">
  {{- range $published }}
  {{ partial "event-card.html" . }}
  {{- end }}
</ul>
{{ else }}
<p style="margin-top: 1.5rem; color: var(--color-muted);">No published events found.</p>
{{ end }}

{{ else }}
{{/* Taxonomy overview page: list all terms with event counts */}}
{{ $taxCSS := resources.Get "css/taxonomy.css" | minify | fingerprint }}
<link rel="stylesheet" href="{{ $taxCSS.RelPermalink }}">

<ul class="taxonomy-list">
  {{- range .Pages }}
  {{ $count := len (where .Pages "Params.status" "published") }}
  {{ if gt $count 0 }}
  <li class="taxonomy-item">
    <a href="{{ .RelPermalink }}">{{ .Title }}</a>
    <span class="taxonomy-count">{{ $count }}</span>
  </li>
  {{ end }}
  {{- end }}
</ul>
{{ end }}
{{ end }}
