{{ $css := resources.Get "css/controls.css" | minify | fingerprint }}
<link rel="stylesheet" href="{{ $css.RelPermalink }}">

<div class="listing-controls">
  <div class="filter-group search-group">
    <label for="filter-search">Search</label>
    <input type="search" id="filter-search" placeholder="Search events..." oninput="applyFilters()">
  </div>

  <div class="filter-group">
    <label for="filter-city">City</label>
    <select id="filter-city" onchange="applyFilters()">
      <option value="">All cities</option>
      {{ $pages := where (where .Site.RegularPages "Section" "events") "Params.status" "published" }}
      {{ $cities := slice }}
      {{ range $pages }}
        {{ with .Params.cities }}
          {{ range . }}
            {{ $cities = $cities | append . }}
          {{ end }}
        {{ end }}
      {{ end }}
      {{ range ($cities | uniq | sort) }}
      <option value="{{ . }}">{{ . }}</option>
      {{ end }}
    </select>
  </div>

  <div class="filter-group">
    <label for="filter-mode">Mode</label>
    <select id="filter-mode" onchange="applyFilters()">
      <option value="">All modes</option>
      {{ $modes := slice }}
      {{ range $pages }}
        {{ with .Params.event_attendance_mode }}
          {{ $modes = $modes | append . }}
        {{ end }}
      {{ end }}
      {{ range ($modes | uniq | sort) }}
      <option value="{{ . }}">{{ . | title }}</option>
      {{ end }}
    </select>
  </div>

  <div class="filter-group">
    <label for="filter-date-from">From</label>
    <input type="date" id="filter-date-from" onchange="applyFilters()">
  </div>

  <button id="btn-reset" class="btn-action" onclick="resetFilters()" style="display:none; align-self:flex-end;">Reset filters</button>
</div>

<div class="listing-subbar">
  <div class="result-count" id="result-count"></div>
  <div class="view-toggle">
    <button id="btn-grid" class="active" onclick="setView('grid')" title="Grid view">Grid</button>
    <button id="btn-list" onclick="setView('list')" title="List view">List</button>
    <button id="btn-calendar" onclick="setView('calendar')" title="Calendar view">Calendar</button>
  </div>
</div>

<div class="calendar-view" id="calendar-view">
  <div class="calendar-header">
    <button onclick="changeMonth(-1)">&larr; Prev</button>
    <h3 id="calendar-month-label"></h3>
    <button onclick="changeMonth(1)">Next &rarr;</button>
  </div>
  <div class="calendar-grid" id="calendar-grid"></div>
</div>
